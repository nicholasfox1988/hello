<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>货物结算清单</title>
    <style>
        th{
            background-color: #f2f2f2;
        }
        table{
            width: 100%;
        }
        td, th{
            padding: 2px;
            text-align: left;
        }
        #total{
            font-size: 30px;
            color:green;
        }
        #span1{
            font-size: 30px;
            color: green;
        }
        #item-select{
            width: 150px;
            height: 40px;
        }
        #item-quantity{
            width: 30px;
            height: 40px;
        }
        #add{
            width: 70px;
            height: 40px;
        }
        #add:hover{
            background-color: green;
        }
        #delete{
            width: 50px;
            height: 25px;
        }
        #delete:hover{
            background-color: orange;
        }
    </style>
</head>
<body>
    <a href="/">首页</a>
    <div>
        <label for="item-select">货物:</label>
        <select id="item-select">
            <option value="老婆饼(1)-2.5">老婆饼</option>
            <option value="混搭餐包(1)-6">混搭餐包</option>
            <option value="椰子小餐包(4)-4.8">椰子小餐包</option>
            <option value="椰蓉小餐包(4)-4.8">椰蓉小餐包</option>
            <option value="菠萝小餐包(4)-4.8">菠萝小餐包</option>
            <option value="奶黄小餐包(4)-4.8">奶黄小餐包</option>
            <option value="红薯岩烧小餐包(4)-6">红薯岩烧小餐包</option>
            <option value="芝士培根小餐包(4)-6">芝士培根小餐包</option>
            <option value="火腿玉米小餐包(4)-6">火腿玉米小餐包</option>
            <option value="肉松小餐包(4)-6">肉松小餐包</option>
            <option value="红豆小餐包(4)-6">红豆小餐包</option>
            <option value="小肠仔餐包(4)-6">小肠仔餐包</option>
            <option value="巧克力小餐包(4)-6">巧克力小餐包</option>
            <option value="芝士香肠小餐包(4)-6">芝士香肠小餐包</option>
            <option value="大菠萝包/紫薯包(1)-2.5">大菠萝包/紫薯包</option>
            <option value="大吐司(1)-4">大吐司</option>
            <option value="肉松小吐司(1)-4">肉松小吐司</option>
            <option value="小吐司:南瓜/提子/椰蓉/巧克力(1)-3.5">小吐司:南瓜/提子/椰蓉/巧克力</option>
            <option value="大叉烧包(1)-3">大叉烧包</option>
            <option value="日式抹茶麻薯包(1)-4">日式抹茶麻薯包</option>
            <option value="日式芋泥麻薯包(1)-4">日式芋泥麻薯包</option>
            <option value="香葱肉松墨西哥包(1)-4">香葱肉松墨西哥包</option>
            <option value="黄油蒜香包(4)-6">黄油蒜香包</option>
            <option value="巧克力菠萝包(4)-6">巧克力菠萝包</option>
            <option value="红豆菠萝包(4)-6">红豆菠萝包</option>
            <option value="芋泥菠萝包(1)-4">芋泥菠萝包</option>
            <option value="肉松菠萝包(1)-4">肉松菠萝包</option>
            <option value="红豆肉松吐司(1)-10">红豆肉松吐司</option>
        </select>
        <label for="item-quantity">数量:</label>
        <input type="number" id="item-quantity" min="1" value="1" onkeydown="handleEnter(event)">
        <button onclick="addItem()" id="add">添加货物</button>
        <button onclick="clearItem()" id="add">清空货物</button>
        <br>
        <span id="span1">&emsp14;货物总计：</span><span id="total">0.00</span>

    </div>
    <br>
    <table id="item-table" border="2">
        <tr>
            <th>货物(一包几个装)</th>
            <th>单价</th>
            <th>数量</th>
            <th>小计</th>
            <th>操作</th>
        </tr>
    </table>
    <script>
        let items = [];
        let total = 0;

        function addItem() {
            const itemName = document.getElementById('item-select').value.split('-')[0];
            const itemPrice = parseFloat(document.getElementById('item-select').value.split('-')[1]);
            const itemQuantity = parseInt(document.getElementById('item-quantity').value);

            const existingItem = items.find(item => item.name === itemName);
            if (itemQuantity > 0) {
                if (existingItem) {
                    existingItem.quantity += itemQuantity;
                } else {
                    items.push({ name: itemName, price: itemPrice, quantity: itemQuantity });
                }
                updateItemTable();
                updateTotal();

                document.getElementById('item-quantity').value = 1;
            } else {
                alert('请输入数量');
            }
        }

        function updateItemTable() {
            const itemTable = document.getElementById('item-table');
            itemTable.innerHTML = `
                <tr>
                    <th>货物(一包几个装)</th>
                    <th>数量</th>
                    <th>单价</th>
                    <th>小计</th>
                    <th>操作</th>
                </tr>
            `;

            items.forEach((item, index) => {
                const row = itemTable.insertRow();
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.quantity}</td>
                    <td>${item.price.toFixed(2)}</td>
                    <td>${(item.price * item.quantity).toFixed(2)}</td>
                    <td><button onclick="removeItem(${index})" id="delete">删除</button></td>
                `;
            });
            
        }

        function updateTotal() {
            const totalElement = document.getElementById('total');
            total = items.reduce((sum, item) => sum + item.price * item.quantity, 0);
            totalElement.textContent = total.toFixed(2);
        }

        function removeItem(index) {
            items.splice(index, 1);
            updateItemTable();
            updateTotal();
        }

        function addOrMergeItem(itemList, newItem) {
            const existingItem = itemList.find(item => item.name === newItem.name);
            
            if (existingItem) {
                return itemList.map(item =>
                    item.name === newItem.name
                        ? { ...item, quantity: item.quantity + newItem.quantity }
                        : item
                );
            } else {
                return [...itemList, newItem];
            }
        }

        function handleEnter(event) {
                if (event.keyCode === 13) {
                    // 阻止默认回车提交行为 (可选，如果需要自定义提交方式)
                    event.preventDefault(); 
                    // 动作
                    addItem();
                }
            }
        function clearItem(){
            const totalElement = document.getElementById('total');
            total=0;
            items=[];
            totalElement.textContent =total.toFixed(2);
            updateItemTable();
        }

    </script>
</body>
</html>
